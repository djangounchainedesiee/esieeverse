{% load static %}
<div class="central-meta">
    <div class="sidebar">
        <div class="nav-item">
            <h5 class="widget-title">Rechercher un membre</h5>
            
            <!--
                <div class="input-group rounded">
                <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
                <span class="input-group-text border-0" id="search-addon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search-heart-fill" viewBox="0 0 16 16">
                        <path d="M6.5 13a6.474 6.474 0 0 0 3.845-1.258h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.008 1.008 0 0 0-.115-.1A6.471 6.471 0 0 0 13 6.5 6.502 6.502 0 0 0 6.5 0a6.5 6.5 0 1 0 0 13Zm0-8.518c1.664-1.673 5.825 1.254 0 5.018-5.825-3.764-1.664-6.69 0-5.018Z"/>
                    </svg>
                </span>
            </div>


            <input type="text" list="userlist" Placeholder="Search Users.." class="form-control" style="width:300px;">
            <datalist id="userlist" >
                {% for nom_utilisateur in noms_utilisateurs %}
                <option value="{{nom_utilisateur}}">
                {% endfor %}
            </datalist>
            -->
            
            <div id="autocomplete" class="autocomplete" [displayWith]="getOptionText">
                <input class="autocomplete-input" id="inputBox"/>
                <ul class="autocomplete-result-list"></ul>
              </div>

            <script>
                new Autocomplete('#autocomplete', {
                    search : input => {
                        const url = `/search/?first_name=${input}`
                        return new Promise(resolve => {
                            fetch(url)
                            .then(response => response.json())
                            .then(data => {
                                resolve(data.data)
                            })
                        })
                    },
                    renderResult: (result, props) => {
                        return `
                        <li ${props}>
                            <div class="wiki-title">
                                ${result.first_name}
                            </div>
                        </li>`
                    },
                    getResultValue: result => result.first_name,
                    onSubmit : result => {
                        window.open(`/profil/${result.id}/`, "_self")
                    },
                    minLength: 1
                })
            </script>
            
        </div>
    </div>
</div>

